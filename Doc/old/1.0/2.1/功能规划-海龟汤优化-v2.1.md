# 功能规划：海龟汤优化 v2.1

> **状态**：已确认  
> **版本**：v2.1-alpha  
> **日期**：2026-01-15  
> **技术方案**：[技术方案-海龟汤优化-v2.1.md](./技术方案-海龟汤优化-v2.1.md)

---

## 一、功能目标

基于 v2.0 的海龟汤基础玩法，通过 **双脑协作 (Split-Brain)** 架构升级，实现：

1. **极速响应**：裁判的"是/否"回答延迟 < 200ms。
2. **精准引导**：基于 KIP (关键信息点) 的客观进度评估。
3. **智能提示**：用户卡住时，AI 主动给出恰当提示。
4. **可视化进度**：前端实时展示游戏进度与"线索墙"。

---

## 二、核心玩法优化

### 2.1 规则回顾

海龟汤是一种**水平思考**推理游戏：
- AI 出一道谜题（"汤面"），并持有谜底（"汤底"）。
- 用户通过**是/否问题**进行推理。
- AI 只能回答：**是 / 不是 / 不重要 / 与此无关**。
- 用户最终需要还原完整的真相。

### 2.2 v2.1 优化点

| 维度 | v2.0 (原版) | v2.1 (优化版) |
|------|-------------|---------------|
| **响应速度** | 依赖 System Prompt 复杂度 | 极简"快系统"，专注判断 |
| **进度评估** | AI 自由裁量 (模糊) | 基于 KIP 的客观打分 |
| **提示机制** | 用户主动请求 | 沉默检测 + AI 主动给出 |
| **前端展示** | 仅显示进度条 | 显示"线索墙"（加密/解密效果） |

---

## 三、关键信息点 (KIP) 设计

每道海龟汤题目需预设 **3-5 个 KIP**，用于客观评估用户进度。

### 3.1 数据结构

```json
{
    "id": "ts_001",
    "title": "半夜敲门",
    "content": "一个人住在山顶的小屋里，半夜听见有人敲门...",
    "answer": "山顶小屋的门是向外推开的。死者听到敲门声去开门...",
    "key_points": [
        "门是向外推开的",
        "推门时把人推下去了",
        "敲门人是来求救的"
    ],
    "hints": ["门是向哪边开的？", "敲门的人在哪里？", "当时天气如何？"],
    "difficulty": 3
}
```

### 3.2 进度评估标准

| 用户状态 | 进度 |
|----------|------|
| 刚开始，未命中 KIP | 0% |
| 命中 1 个 KIP | 33% |
| 命中 2 个 KIP | 66% |
| 命中全部 KIP，差细节 | 90% |
| 完整复述真相 | 100% |

---

## 四、提示策略

### 4.1 触发条件

提示由 **慢系统 (Judge LLM)** 决策，触发条件：

| 条件 | 提示强度 | 说明 |
|------|----------|------|
| 用户沉默 8-12s | 低 (引导方向) | "你还没有问过现场的环境哦..." |
| 用户沉默 15s+ | 高 (释放线索) | "偷偷告诉你，那根本不是血，是..." |
| 用户多次在同一点打转 | 中 (纠偏) | "换个方向想想，凶器不一定是刀..." |

### 4.2 提示内容来源

1. **来自 hints 库**: 优先使用题目预设的 hints。
2. **来自 Judge 生成**: 若 hints 用尽，Judge LLM 根据答案动态生成。

---

## 五、前端交互设计

### 5.1 游戏信息卡片 (Game Info Card)

```text
┌──────────────────────────────────────┐
│  🐢 海龟汤：半夜敲门                  │
├──────────────────────────────────────┤
│  [汤面]                              │
│  一个人住在山顶的小屋里，半夜听见...     │
│  (点击展开更多)                       │
├──────────────────────────────────────┤
│  当前进度:  ■■■■□□□□□□  40%           │
├──────────────────────────────────────┤
│  [线索墙]                            │
│                                      │
│  1. 门的特点:    向外开    [✅ 已解锁]  │
│  2. 推门结果:    ******    [🔒 未解锁]  │
│  3. 敲门人身份:  ******    [🔒 未解锁]  │
│                                      │
└──────────────────────────────────────┘
```

### 5.2 交互效果

- **解锁动画**: 用户猜中某个 KIP 时，对应行播放翻牌/高亮动画。
- **进度条更新**: 实时反映 Judge 返回的 `progress_score`。
- **折叠汤面**: 游戏进行中可折叠，避免占用过多空间。

---

## 六、确认记录 (v2.1 新增)

| 问题 | 确认结果 |
|------|----------|
| 双脑架构仅用于海龟汤 | ✅ 是 |
| 快系统不包含任何后门 | ✅ 是 |
| 传声筒模式 (Parrot Mode) | ✅ 选用 |
| KIP 由题库预设 | ✅ 是 |
| 前端展示线索墙 | ✅ 是 |

---

## 七、后续扩展 (可选)

- [ ] 支持用户自定义题目 (UGC)
- [ ] 支持多人协作推理 (房间模式)
- [ ] 支持 AI 动态生成新题
